<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>STEVE (Simultaneous Thread EValuation of gEant4): runSim.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">STEVE (Simultaneous Thread EValuation of gEant4)
   </div>
   <div id="projectbrief">Workaround for multithreading singlethreaded simulations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('runSim_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">runSim.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string&gt;</code><br/>
<code>#include &lt;iostream&gt;</code><br/>
<code>#include &lt;thread&gt;</code><br/>
<code>#include &lt;vector&gt;</code><br/>
<code>#include &lt;mutex&gt;</code><br/>
<code>#include &lt;ctime&gt;</code><br/>
<code>#include &lt;limits.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;cstring&gt;</code><br/>
</div>
<p><a href="runSim_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a725c28a31a136377b71c6e5c19dcf5cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runSim_8h.html#a725c28a31a136377b71c6e5c19dcf5cc">bash</a> (std::string command, int nice)</td></tr>
<tr class="separator:a725c28a31a136377b71c6e5c19dcf5cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f79fe88017c77fe691dca577d3fe49"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runSim_8h.html#a77f79fe88017c77fe691dca577d3fe49">ReplaceString</a> (std::string subject, const std::string &amp;search, const std::string &amp;replace)</td></tr>
<tr class="separator:a77f79fe88017c77fe691dca577d3fe49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06518186b71ee251267b4ff65a19a8d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runSim_8h.html#a06518186b71ee251267b4ff65a19a8d1">regexReplace</a> (string &amp;input, const string threadnumber)</td></tr>
<tr class="separator:a06518186b71ee251267b4ff65a19a8d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ec0c0df95b1118b42d75ecc3709e81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runSim_8h.html#a55ec0c0df95b1118b42d75ecc3709e81">runSimRegex</a> (string regex, string num)</td></tr>
<tr class="separator:a55ec0c0df95b1118b42d75ecc3709e81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7a2bab796ef54fdf5d67d6545d366ab"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runSim_8h.html#aa7a2bab796ef54fdf5d67d6545d366ab">clean</a> (bool autoClean, string cleanCMD)</td></tr>
<tr class="separator:aa7a2bab796ef54fdf5d67d6545d366ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27437496827a50782b3aab97750f7e3c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runSim_8h.html#a27437496827a50782b3aab97750f7e3c">directoryContains</a> (string dir)</td></tr>
<tr class="separator:a27437496827a50782b3aab97750f7e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35abd590b8d2010d6beb9e0c6b103eba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runSim_8h.html#a35abd590b8d2010d6beb9e0c6b103eba">runSim</a> (string regex, string numSims, string output, string cleanCMD, bool autoClean, bool afterClean)</td></tr>
<tr class="separator:a35abd590b8d2010d6beb9e0c6b103eba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a725c28a31a136377b71c6e5c19dcf5cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bash </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nice</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Call the given command in bash</h2>
<h3>Arguments</h3>
<p><code>std::string command</code> - Command to run. Note that non-interpreters wrappers like nice may not work with aliased commands.</p>
<p><code>int nice</code> - nice value to run command at (added to avoid issues with nice not working with aliases). Defualts to zero.</p>
<h3>Returns the return value of the given function</h3>

<p>Referenced by <a class="el" href="runSim_8h.html#aa7a2bab796ef54fdf5d67d6545d366ab">clean()</a>, <a class="el" href="runSim_8h.html#a35abd590b8d2010d6beb9e0c6b103eba">runSim()</a>, and <a class="el" href="runSim_8h.html#a55ec0c0df95b1118b42d75ecc3709e81">runSimRegex()</a>.</p>

</div>
</div>
<a class="anchor" id="aa7a2bab796ef54fdf5d67d6545d366ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool clean </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>autoClean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>cleanCMD</em> = <code>&quot;rm&#160;-f&#160;*.root;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Clean the current directory</h2>
<h3>Arguments:</h3>
<p><code>bool autoClean</code> - Bool of whether or not to automatically clean the directory. It defualts to zero, which will prompt the user first, but if set to one the program cleans the directory without outside input.</p>
<h3>Notes:</h3>
<p>Ensures there are no files matching g4out*.root in the current directory. If there are, it offers to automatically remove them, or to exit the program to allow the user to save and remove them manually. Also note that this assumes that all output files end in <code>.root</code>, and no other files end in <code>.root</code>. If you want to preserve these files, you should move them to a differnt directory or change their filename (as an example, <code>g4out.root</code>-&gt;<code>g4out.root.keep</code>). </p>

<p>Referenced by <a class="el" href="runSim_8h.html#a35abd590b8d2010d6beb9e0c6b103eba">runSim()</a>.</p>

</div>
</div>
<a class="anchor" id="a27437496827a50782b3aab97750f7e3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool directoryContains </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Check current directory contains the string provided/</h2>
<h3>Arguments:</h3>
<p><code>string dir</code> - Directory to check if contained</p>
<h3>Notes:</h3>
<p>If it is, it returns zero, otherwise it prompts the user if they want to procede anyway or not. Returns 0 if they want to procede and 1 otherwise. </p>

<p>Referenced by <a class="el" href="runSim_8h.html#a35abd590b8d2010d6beb9e0c6b103eba">runSim()</a>.</p>

</div>
</div>
<a class="anchor" id="a06518186b71ee251267b4ff65a19a8d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void regexReplace </td>
          <td>(</td>
          <td class="paramtype">string &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string&#160;</td>
          <td class="paramname"><em>threadnumber</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Apply regex transformations to input string.</h2>
<h3>Arguments:</h3>
<p><code>string&amp; input</code> - Input string reference to modify in place.</p>
<p><code>const string threadnumber</code> - Threadnumber string to replace n with. Only valid for threads, so it defaults to "".</p>
<h3>Transformations:</h3>
<p>"%d" -&gt; date</p>
<p>"%t" -&gt; time</p>
<p>"%u" -&gt; unix time</p>
<p>"%n" -&gt; thread number </p>

<p>Referenced by <a class="el" href="runSim_8h.html#a35abd590b8d2010d6beb9e0c6b103eba">runSim()</a>, and <a class="el" href="runSim_8h.html#a55ec0c0df95b1118b42d75ecc3709e81">runSimRegex()</a>.</p>

</div>
</div>
<a class="anchor" id="a77f79fe88017c77fe691dca577d3fe49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ReplaceString </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>subject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>search</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>replace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Replace all instances of a string in another string with a third string. Credit to Czarek Tomczak on stack overflow for supplying the code in response to a question asked by NullVoxPopuli.</h2>
<h3>Arguments:</h3>
<p><code>std::string subject</code> - String to do replacements in.</p>
<p><code>const std::string&amp; search</code> - Substring to replace with the <code>replace</code> string.</p>
<p><code>const std::string&amp; replace</code> - Substring to replace the <code>search</code> string with. </p>

<p>Referenced by <a class="el" href="runSim_8h.html#a06518186b71ee251267b4ff65a19a8d1">regexReplace()</a>.</p>

</div>
</div>
<a class="anchor" id="a35abd590b8d2010d6beb9e0c6b103eba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int runSim </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>regex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>numSims</em> = <code>&quot;48&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>output</em> = <code>&quot;g4out.root&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>cleanCMD</em> = <code>&quot;rm&#160;-f&#160;*.root&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>autoClean</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>afterClean</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Runs the multithreading workaround. Exists so that it can be easily called from another program.</h2>
<h3>Arguments:</h3>
<p><code>string regex</code> - Runs the simulation from the string provided once all instances of "%n" are replaced by the thread number. It allows for more flexibility in command execution as the singlethreaded command for any simulation (that has the two modifications described below) can easily be multithreaded. Make sure to redirect stdout and stderr to a file or /dev/null to prevent simultaneous writing to the console. Note that the string should be surrounded in quotes as to not specify additional arguments.</p>
<p><code>string numSims</code> - Number of threads to run. Defaults to 48.</p>
<p><code>string output</code> - Final combined output .root filename. Defaults to <code>g4out.root</code>.</p>
<p><code>string cleanCMD</code> - Supply your own clean command. If not included, default clean command is <code>rm -f *.root</code>. This can reference a file if the command executes a file.</p>
<p><code>bool autoClean</code> - Automatically cleans directory and skips directory check without user input.</p>
<p><code>bool afterclean</code> - Cleans directory after simulation completion by adding .keep to the end of the output file, then running the clean function, which is by defailt <code>rm -f *.root</code>, then moving the output back to the original filename. </p>

<p>Referenced by <a class="el" href="runSim_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a55ec0c0df95b1118b42d75ecc3709e81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void runSimRegex </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>regex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Run a thread of the simulation</h2>
<h3>Arguments:</h3>
<p><code>string regex</code> - Command to run for each string, where every instance of "%n" will be replaced with the thread number.</p>
<p><code>string num</code> - Thread number </p>

<p>Referenced by <a class="el" href="runSim_8h.html#a35abd590b8d2010d6beb9e0c6b103eba">runSim()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="runSim_8h.html">runSim.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
